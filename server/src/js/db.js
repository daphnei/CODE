// Generated by CoffeeScript 1.7.1
(function() {
  var Q, connection, getQuestionsFromTable, mysql, resolveQueryAsPromise, withConnection;

  mysql = require('mysql');

  Q = require('Q');

  connection = mysql.createConnection({
    host: 'sql3.freemysqlhosting.net',
    user: 'sql330935',
    password: 'fW2!cZ8%',
    database: 'sql330935'
  });

  withConnection = function(fn) {
    connection.connect();
    fn();
    return connection.end();
  };

  resolveQueryAsPromise = function(promiseObj, err, rows, fields) {
    if (err) {
      return promiseObj.reject(err);
    } else {
      return promiseObj.resolve(rows);
    }
  };

  getQuestionsFromTable = function(name, limit) {
    var data;
    data = Q.defer();
    withConnection(function() {
      var queryString;
      queryString = 'SELECT * FROM ?? LIMIT ?';
      return connection.query(queryString, [name, limit], function(err, rows, fields) {
        return resolveQueryAsPromise(data, err, rows, fields);
      });
    });
    return data.promise;
  };

  exports.getQuestions = function(type, limit) {
    return getQuestionsFromTable(type + '_questions', limit);
  };

}).call(this);
